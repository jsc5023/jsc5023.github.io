---
layout: post
title: "build.gradle 사용시 키워드 정리하기"
date: 2025-01-20
categories: [문제 해결]
tags: [Java, Hibernate, JPA]
---

Hibernate를 사용하면서 `ddl-auto` 설정 때문에 겪었던 문제와 그 해결 방법을 공유합니다. 이 글에서는 문제 상황, 해결 과정, 그리고 배운 점을 간단히 정리해 보았습니다.

---

## 문제 상황

JPA와 Hibernate를 사용하는 도중, 다음과 같이 `ddl-auto: update` 설정을 사용하고 있었습니다:

```yaml
jpa:
  hibernate:
    ddl-auto: update
```

이 설정은 테이블을 유지하면서 변경 사항을 반영하도록 도와줍니다. 하지만, **컬럼 이름을 변경하거나 데이터 타입을 수정**하는 경우에는 문제가 발생할 수 있습니다.

### 오류 발생 예시
- 기존 테이블의 **컬럼 이름을 변경**한 뒤 애플리케이션을 실행했을 때, 테이블이 제대로 업데이트되지 않았습니다.
- 로그에는 관련 오류 메시지가 출력되었고, 애플리케이션이 정상적으로 실행되지 않았습니다.

---

## 해결 방법

이 문제를 해결하기 위해 다음 단계를 진행했습니다:

1. **`ddl-auto` 설정 변경**  
   컬럼 변경 사항을 반영하기 위해 `ddl-auto`를 `create`로 설정했습니다:
   ```yaml
   jpa:
     hibernate:
       ddl-auto: create
   ```
   이 설정은 기존 테이블을 삭제하고, 새로운 테이블을 생성합니다.

2. **애플리케이션 실행**  
   변경된 컬럼 이름과 데이터 타입이 반영된 새 테이블이 생성되었습니다.

3. **`ddl-auto` 설정 복구**  
   이후, `create` 설정을 다시 `update`로 변경하여 테이블을 유지하면서 추가적인 변경 작업을 진행할 수 있었습니다:
   ```yaml
   jpa:
     hibernate:
       ddl-auto: update
   ```

---

## 배운 점

1. **`ddl-auto` 설정 옵션 이해**
   - `create`: 기존 테이블을 삭제하고 새로 생성.
   - `update`: 기존 테이블을 유지하며 변경 사항을 반영. 하지만 컬럼 이름 변경 등 일부 작업은 반영되지 않을 수 있음.
   - `validate`: 테이블과 매핑 정보의 일치 여부를 검증. 변경 작업은 하지 않음.
   - `none`: 아무 작업도 하지 않음.

2. **컬럼 변경 시 `update`의 한계**
   - `update`는 새로운 컬럼 추가나 기본적인 변경에는 적합하지만, **컬럼 이름 변경이나 데이터 타입 변경은 반영되지 않음**.

3. **개발 환경과 프로덕션 환경의 차이**
   - 개발 환경에서는 `create`나 `update`를 자유롭게 사용할 수 있지만, **프로덕션 환경에서는 데이터 손실 방지를 위해 마이그레이션 도구(Flyway, Liquibase 등)**를 사용하는 것이 권장됩니다.

---

## 결론

Hibernate의 `ddl-auto` 설정은 편리하지만, 컬럼 변경 작업에서 예상치 못한 문제가 발생할 수 있습니다.  
이를 해결하기 위해 적절한 설정 변경과 마이그레이션 도구 활용이 필요합니다.  

이번 경험은 Hibernate와 JPA를 사용하는 데 있어 중요한 교훈을 주었습니다.  
비슷한 문제를 겪는 분들께 도움이 되길 바랍니다!
